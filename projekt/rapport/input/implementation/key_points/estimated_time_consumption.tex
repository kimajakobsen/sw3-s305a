\section{Estimated Time Consumption}
\label{sec:estimated_time_consumption}

The \me{CalculateEstimatedTimeConsumption()} function -- which is a method in the \cl{Problem} class -- estimates how much time is needed to solve the specific problem, under the assumption that there only exists this single problem on the assigned staff members queue. The idea is to sum up all the \vari{AverageTimeSpent} property as well as all the count the number of tags, and lastly calculate the average time for all the tags. See code snippet \ref{lst:estimatedtimeconsumption}.

\begin{lstlisting}[style=sourceCode, caption=\myCaption{The ManageTagTimes method. In lines one to seven a property is shown, which wraps the method in lines nine to forty-three.}, label=lst:estimatedtimeconsumption]
public TimeSpan EstimatedTimeConsumption
{
    get
    {
        return CalculateEstimatedTimeConsumption();
    }
}

private TimeSpan CalculateEstimatedTimeConsumption()
{
    int NumberOfTags = 0;
    decimal? ProblemTime = 0;
    int Minutes = 0;
    int Hours = 0;
    int Days = 0;

    decimal? average = 0;

    foreach (Tag tag in Tags)
    {
        if (tag.AverageTimeSpent != null)
        {
            ProblemTime = ProblemTime + tag.AverageTimeSpent;
        }
        NumberOfTags++;
    }

    if (NumberOfTags == 0)
    {
        average = 10;
    }
    else
    {
        average = ProblemTime / NumberOfTags;
    }

    Hours = (int)average % 60;
    Minutes = (int)average - (Hours*60);
    Days = Hours % 24;
    Hours = Hours - (Days * 24);

    return new TimeSpan(Days, Hours, Minutes, 0);
}
\end{lstlisting}